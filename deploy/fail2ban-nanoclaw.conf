# Fail2ban filter for NanoClaw webhook abuse
# Install: sudo cp deploy/fail2ban-nanoclaw.conf /etc/fail2ban/filter.d/nanoclaw.conf
#
# Matches nginx access log entries for:
# - Repeated 4xx errors on webhook endpoint
# - 429 rate limit responses (already being abused)
# - 401 unauthorized (bad signature)

[Definition]
failregex = ^<HOST> .* "(POST|GET|PUT|DELETE) /webhook/.* HTTP/.*" (4[0-9]{2}) .*$
ignoreregex =
